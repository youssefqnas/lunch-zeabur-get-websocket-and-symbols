# Dockerfile

# -----------------
# 1. مرحلة البناء (Build Stage)
# -----------------

# ابدأ من صورة بايثون رسمية. نسخة "slim" تكون أصغر حجماً وأكثر كفاءة.
FROM python:3.9-slim-bullseye

# عيّن مجلد العمل داخل الحاوية. جميع الأوامر التالية ستنفذ من هذا المسار.
WORKDIR /app

# -----------------
# 2. تثبيت الاعتماديات (Dependencies)
# -----------------

# انسخ ملف الاعتماديات أولاً.
# هذه الخطوة تستفيد من التخزين المؤقت في دوكر (caching).
# إذا لم يتغير ملف requirements.txt، لن يتم إعادة تنفيذ هذه الخطوة في عمليات البناء التالية.
COPY requirements.txt .

# قم بتثبيت جميع المكتبات المذكورة في الملف.
# --no-cache-dir يمنع pip من تخزين الكاش لتقليل حجم الصورة النهائية.
RUN pip install --no-cache-dir -r requirements.txt

# -----------------
# 3. نسخ الكود وتشغيل التطبيق
# -----------------

# الآن، انسخ باقي ملفات المشروع (مثل main.py) إلى مجلد العمل.
COPY . .

# الأمر الذي سيتم تنفيذه عند بدء تشغيل الحاوية.
# سيقوم بتشغيل السكريبت الرئيسي الخاص بك.
CMD ["python", "main.py"]